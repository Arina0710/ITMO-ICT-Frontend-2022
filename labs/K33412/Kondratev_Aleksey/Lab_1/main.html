<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Главная страница">
	<title>Главная</title>
	<link rel="stylesheet" href="./vendor/normalize.css">
	<link rel="stylesheet" href="./styles/main.css">
	<link rel="stylesheet" href="./styles/light.css" media="(prefers-color-scheme: light)">
	<link rel="stylesheet" href="./styles/dark.css" media="(prefers-color-scheme: dark)">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
</head>
<body>
	<header class="container-fluid colors">
		<nav class="navbar navbar-expand-md d-flex justify-content-between">
			<div>
				<a class="colors navbar-brand text-color fs-4 p-2" href="./main.html">Главная</a>
				<a class="colors navbar-brand text-color fs-6 p-2" href="./calendar.html">Календарь</a>
			</div>
			<div>
				<button class="colors navbar-brand text-color fs-6" id="entry">Вход</button>
				<button class="colors navbar-brand text-color fs-6 button-logout" id="exit">Выход</button>
				<button class="colors navbar-brand text-color fs-6" id="register">Регистрация</button>
				<button class="colors navbar-brand text-color fs-5 p-2" id="lc">Личный кабинет</button>
			</div>
		</nav>
	</header>

	<main class="container-fluid background-main">
		<section class="row row-cols-2 pt-5">
			<div class="d-flex flex-column justify-content-center align-items-end col-5">
				<h1 class="w-75 h1 pb-3 text-color">События обьединяют</h1>
				<p class="w-75 pt-6 text-color">Посещайте конференции и лекции, ходите на выставки и концерты, занимайтесь саморазвитием и ищите единомышленников</p>
			</div>
			<img class="w-50" src="./image/people.png" alt="Радующиеся люди">
		</section>

		<section class="d-flex flex-column align-items-center pt-5">
			<h2 class="h2 mb-4 text-color">Актуальные мероприятия</h2>
			<div class="d-flex justify-content-center m-0">
				<p class="fs-5 pe-3 text-color">Сортировать</p>
				<div class="dropdown me-3">
					<select class="form-select-sm event-type" aria-label=".form-select-lg example">
						<option value="all">Выберите, чем хотите заняться</option>
						<option value="active">Спорт</option>
						<option value="music">Музыка</option>
					</select>
				</div>
				<div class="dropdown me-3">
					<select class="form-select-sm city-type" aria-label=".form-select-lg example">
						<option value="everything">Выберите город</option>
						<option value="moscow">Москва</option>
						<option value="tver">Тверь</option>
						<option value="saint">Санкт-Петербургс</option>
					</select>
				</div>
				<form class="search-form d-flex justify-content-end col-12 col-sm-2 col-lg-4 col-xl-6">
					<button type="submit" id="search" class="btn btn-info btn-sm " style="background-color:#d2cb60; border: 1px solid #d2cb60;">Поиск</button>
				</form>
			</div>
			<div class="row justify-content-center pt-5 pb-5">
				<div class="card me-4 everything active tver card-colors background text-color" style="width: 18rem;" data-event-id="1">
					<img src="./image/cards/sport.jfif" class="card-img-top" width="262" alt="Люди бегут на марафоне" style="height: 11rem;">
					<div class="card-body">
						<h3 class="card-title">Марафон</h3>
						<p class="card-text">Спорт</p>
						<p class="card-data">Тверь</p>
					<a href="./event.html" class="btn btn-primary">На сайт мероприятия</a>
					<form action="" onsubmit="subscribe(1)">
						<button type="submit" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
							Записаться
						</button>
					</form>
					</div>
				</div>
				<div class="card me-4 everything music moscow card-colors background text-color" style="width: 18rem;" data-event-id="2">
					<img src="./image/cards/musicMoscow.jpg" class="card-img-top" width="262" alt="Люди убирают мусор" style="height: 11rem;">
					<div class="card-body">
						<h3 class="card-title">Новое выступление</h3>
						<p class="card-text">Музыка</p>
						<p class="card-data">Москва</p>
					<a href="./event.html" class="btn btn-primary">На сайт мероприятия</a>
					<form action="" onsubmit="subscribe(2)">
						<button type="submit" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
							Записаться
						</button>
					</form>
					</div>
				</div>
				<div class="card me-4 everything music saint card-colors background text-color" style="width: 18rem;" data-event-id="3">
					<img src="./image/cards/musicSaint.jpg" class="card-img-top" width="262" alt="Человек учиться на дистанте" style="height: 11rem;">
					<div class="card-body">
						<h3 class="card-title">Увлекательное шоу</h3>
						<p class="card-text">Музыка</p>
						<p class="card-data">Санкт-Петербург</p>
					<a href="./event.html" class="btn btn-primary">На сайт мероприятия</a>
					<form action="" onsubmit="subscribe(3)">
						<button type="submit" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
							Записаться
						</button>
					</form>
					</div>
				</div>
				<div class="card me-4 everything active moscow card-colors background text-color" style="width: 18rem;" data-event-id="4">
					<img src="./image/cards/sportMoscow.webp" class="card-img-top" width="262" alt="Люди идут в поход" style="height: 11rem;">
					<div class="card-body">
						<h3 class="card-title">К спорту вместе!</h3>
						<p class="card-text">Спорт</p>
						<p class="card-data">Москва</p>
					<a href="./event.html" class="btn btn-primary">На сайт мероприятия</a>
					<form action="" onsubmit="subscribe(4)">
						<button type="submit" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
							Записаться
						</button>
					</form>
					</div>
				</div>
			</div>
		</section>
	</main>

	<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h3 class="modal-title" id="exampleModalLabel">Вы записаны</h3>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Ждем вас на нашем мероприятие с хорошим настроением
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
				</div>
			</div>
		</div>
	</div>

	<footer class="container-fluid pt-5 colors">
		<div class="row justify-content-between p-2">
			<div class="col-2 text-color">
				<h3>Ваш аккаунт</h3>
				<ul class="nav flex-column">
					<li class="nav-item mb-2"><a href="./personal-area.html" class="nav-link p-0 text-color">Личный кабинет</a></li>
					<li class="nav-item mb-2"><a href="./entry.html" class="nav-link p-0 text-color">Вход</a></li>
					<li class="nav-item mb-2"><a href="./reqistration.html" class="nav-link p-0 text-color">Регистрация</a></li>
				</ul>
			</div>

			<div class="col-2 text-color">
				<h3>Найти</h3>
				<ul class="nav flex-column">
					<li class="nav-item mb-2"><a href="./calendar.html" class="nav-link p-0 text-color">Календарь</a></li>
					<li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-color">Поиск мероприятий</a></li>
				</ul>
			</div>

			<div class="col-2 text-color">
				<h3>О нас</h3>
				<ul class="nav flex-column">
					<li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-color">ВКонтакте</a></li>
					<li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-color">Телеграм</a></li>
				</ul>
			</div>

			<div class="col-4 offset-1">
				<form>
					<h3 class="text-color">Подпишись на нас, чтобы не пропустить ничего интересного</h3>
					<div class="d-flex w-100 gap-2">
						<label for="newsletter1" class="visually-hidden">Ваша почта</label>
						<input id="newsletter1" type="text" class="form-control" placeholder="example@email.com">
						<button class="btn btn-primary" type="button">Подписаться</button>
					</div>
				</form>
			</div>
		</div>

		<div class="d-flex justify-content-between py-4 my-4 mb-0 border-top text-color">
			<p>&copy 2022, Кондратьев Алексей</p>
		</div>
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
	<script src="./scripts/header.js"></script>
	<script>
		const eventOptions = document.querySelector('.event-type');
		const cityOptions = document.querySelector('.city-type');
		const cards = document.querySelectorAll(".card");

		async function subscribe(id) {
			const userId = JSON.parse(localStorage.user).id;
			const userEvent = {
				"userId": userId,
				"eventId": id
			}
			console.log(userEvent)
			const response = await fetch('http://localhost:3000/userEvents', {
				method: "POST",
				body: JSON.stringify(userEvent),
				headers: {
					'Content-Type': 'application/json'
				}
			})
		}

		eventOptions.addEventListener('change', (event) => {
			const { value } = event.target
		})

		cityOptions.addEventListener('change', (event) => {
			const { value } = event.target
		})

		function filter() {
			const searchForm = document.querySelector('.search-form')
			searchForm.addEventListener('submit', (event) => {
				event.preventDefault();
				const eventTypeValue = eventOptions.value;
				const cityTypeValue = cityOptions.value;
				console.log(eventTypeValue);
				console.log(cityTypeValue);

				switch(eventTypeValue) {
					case 'all':
						cards.forEach(card => {
							if (card.classList.contains(cityTypeValue)) {
								card.style.display = 'block'
							} else {
								card.style.display = 'none'
							}
						}) 
								break
					case 'active':
						cards.forEach(card => {
							if (card.classList.contains('active') && card.classList.contains(cityTypeValue)) {
								card.style.display = 'block'
							} else {
								card.style.display = 'none'
							}
						})
						break
					case 'music':
					cards.forEach(card => {
						if (card.classList.contains('music') && card.classList.contains(cityTypeValue)) {
							card.style.display = 'block'
						} else {
							card.style.display = 'none'
						}
					})
					break
				}
			})
		}

		filter();
	</script>
</body>
</html>
